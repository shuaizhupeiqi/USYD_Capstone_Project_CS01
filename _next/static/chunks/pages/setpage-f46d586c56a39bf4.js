(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1331],{20310:function(t,e,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/setpage",function(){return i(53358)}])},46982:function(t,e,i){"use strict";var n=i(85893),s=i(36465),a=i.n(s),o=i(67294),r=i(11163),l=i(69400);(0,i(4480).cn)({key:"isModalOpenState",default:!1});let d={maxHeight:"80vh",maxWidth:"90vw",overflowY:"auto",overflowX:"hidden"},h=t=>{let{child:e,content:i}=t,[s,r]=(0,o.useState)(!1),h=t=>{r(!0),console.log("Showing modal"),t.stopPropagation()},c=t=>{r(!1),console.log("Closing modal"),t.stopPropagation()};return(0,n.jsxs)("div",{className:"jsx-28fdcef7af6d039c",children:[(0,n.jsx)(a(),{id:"28fdcef7af6d039c",children:".ant-modal-close-x{margin-right:-20px}.ant-modal-close-x:hover,.ant-modal-close-x:focus{background-color:transparent!important}.ant-modal-close:hover,.ant-modal-close:focus,.ant-modal-close .ant-modal-close-x:hover,.ant-modal-close .ant-modal-close-x:focus{background-color:transparent!important}"}),o.cloneElement(e,{onClick:h}),(0,n.jsx)("div",{onClick:t=>t.stopPropagation(),className:"jsx-28fdcef7af6d039c",children:(0,n.jsx)(l.Z,{footer:null,visible:s,onCancel:c,bodyStyle:d,getContainer:!1,children:i})})]})};e.Z=(0,r.withRouter)(h)},53358:function(t,e,i){"use strict";i.r(e);var n=i(67573),s=i(85893),a=i(67294),o=i(11163),r=i.n(o),l=i(85813),d=i(26981),h=i(96108),c=i(46409),g=i(71577),u=i(71230),p=i(15746),m=i(98166),f=i(96074),x=i(98293),S=i(55241),v=i(73857),C=i(23681),Z=i(81921),y=i(19996);i(46982);var j=i(51146),w=i(87547),b=i(3253),T=i(18429),k=i(60219),I=i(45742),P=i(12610),L=i(42207);i(53358);var O=i(16397),A=i(19426),F=i(83005),E=i(35878),B=i(75884),V=i(39960),N=i(37744),D=i(44866);i(48562);var z=i(61800);let{Meta:W}=l.Z,{TabPane:R}=d.Z,_=window.innerWidth<=768;class H extends a.Component{componentDidMount(){this.loadTranslation(),window.innerWidth}componentWillUnmount(){this.state.latestFormValues&&!this.state.saveButtonClicked&&this.onSaveData(this.state.latestFormValues,!1)}async loadTranslation(){let{languageHelper:t}=this.props,e=await t.translation("SettingPage",!0);(0,B.a)(async(t,i)=>{this.setState({user:i}),t&&this.setState({isLoggedIn:!0}),i&&i.emailVerified&&this.setState({isEmailVerified:!0});let n=(0,F.y)();if(t&&i&&i.emailVerified)try{let n=await (0,N.xK)("users/".concat(i.uid));this.setState({data:n.settings,translation:e.translation,settingOptions:e.data,isLoggedIn:t,loading:!1})}catch(s){console.error("Operation failed:",s);let i={};n&&(i=n),this.setState({data:i,translation:e.translation,settingOptions:e.data,isLoggedIn:t,loading:!1})}else n?this.setState({data:n,translation:e.translation,settingOptions:e.data,isLoggedIn:t,loading:!1}):this.setState({data:{},translation:e.translation,settingOptions:e.data,isLoggedIn:t,loading:!1})})}generateFormElements(t,e){return"multiple"===t.optionType?this.generateMultipleOption(t,e):this.generateSingleOption(t,e)}generateSingleOption(t,e){return(0,s.jsx)(h.Z.Item,{label:t.label,name:t.name,children:(0,s.jsx)(c.Z,{children:t.options.map((t,i)=>(0,s.jsx)(c.Z.Option,{value:JSON.stringify(t.value),children:t.label},i+e))})},e)}generateMultipleOption(t,e){let i=t.options.map(t=>({label:t.label,value:JSON.stringify(t.value)}));return(0,s.jsx)(h.Z.Item,{label:t.label,name:t.name,children:(0,s.jsx)(c.Z,{mode:"multiple",showArrow:!0,style:{width:"100%"},options:i})},e)}NotVerfiedHeader(){return(0,s.jsx)("div",{children:_?null:(0,s.jsx)("div",{style:{width:"97%",backgroundColor:"salmon",marginTop:"1%",borderRadius:"10px",paddingLeft:"3%",color:"white"},children:(0,s.jsxs)("p",{children:[this.state.translation.NotVerifiedNote," â€ƒ",(0,s.jsx)("span",{onClick:this.resendVerificationEmail,style:{cursor:"pointer",textDecoration:"underline",color:"blue"},children:this.state.translation.ResendLink})]})})})}UserNameHeader(){let t=this.state.user;return t?(0,s.jsxs)("p",{children:[this.state.translation.Hello,": ",t.displayName]}):null}openProfilePage(){this.setState({openProfile:!0})}renderLoggedInButton(){return(0,s.jsx)(g.ZP,{style:{backgroundColor:"#1677ff",color:"white",fontWeight:"bold"},onClick:this.openProfilePage.bind(this),children:this.state.translation.ManageYourProfile})}render(){return(0,s.jsxs)("div",{style:this.state.openProfile?{width:"100vw",position:"fixed"}:null,children:[this.state.openProfile?(0,s.jsx)(j.Z,{doSignOut:this.doSignOut,closeProfilePage:this.closeProfilePage}):null,(0,s.jsxs)(C.default,{children:[(0,s.jsx)(u.Z,{style:{marginTop:"10px"},children:(0,s.jsx)(p.Z,{span:24,children:(0,s.jsx)(m.Z,{message:this.state.translation.Notice,description:(0,s.jsx)("div",{style:{padding:"0 0px"},children:(0,s.jsx)("span",{style:{color:O.MA[3]},children:this.state.isLoggedIn?this.state.translation.LoggedInText:this.state.translation.NotLoginText})}),type:"info",showIcon:!0,action:this.state.isLoggedIn?(0,s.jsx)(g.ZP,{size:"small",type:"primary",onClick:this.handleCloseAlert,children:"Accept"}):null,closable:!0})})}),(0,s.jsx)(f.Z,{orientation:"left",style:{color:O.iN[6]}}),(0,s.jsxs)(u.Z,{style:{marginTop:"20px",marginBottom:"20px",flexDirection:"column",display:"flex",alignItems:"center"},children:[" ",(0,s.jsx)(p.Z,{style:{textAlign:"center",marginBottom:"10px"},children:(0,s.jsx)(x.C,{size:{xs:100,sm:100,md:100,lg:120,xl:150,xxl:180},icon:(0,s.jsx)(w.Z,{style:{fontSize:this.getIconSize(),color:"black"}})})}),(0,s.jsx)(p.Z,{style:{textAlign:"center"},children:this.state.isLoggedIn?(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{children:this.state.user.name}),(0,s.jsx)("div",{children:this.state.user.email}),(0,s.jsx)("div",{children:this.state.user.phone}),(0,s.jsx)("div",{style:{marginTop:"5px"},children:this.renderLoggedInButton()})]}):(0,s.jsx)("div",{children:(0,s.jsx)(S.Z,{content:(0,s.jsx)("div",{id:"firebaseui"}),title:(0,s.jsxs)("div",{children:[(0,s.jsx)(b.Z,{}),(0,s.jsx)(T.Z,{style:{float:"right"},onClick:this.handlePopoverClose})]}),trigger:"click",open:this.state.open,onOpenChange:this.handleOpenChange,autoAdjustOverflow:!0,getPopupContainer:t=>t.parentNode,overlayStyle:{width:"300px"},children:(0,s.jsx)(g.ZP,{style:{backgroundColor:"#1677ff",color:"white",fontWeight:"bold"},icon:(0,s.jsx)(b.Z,{}),children:this.state.translation.LoginButton})})})})]}),this.state.isLoggedIn&&!this.state.isEmailVerified?this.NotVerfiedHeader():null,this.state.loading?(0,s.jsx)(y.Z,{}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.Z,{orientation:"left",style:{color:O.iN[6]}}),(0,s.jsx)(v.Z,{style:{margin:"16px 0"},children:this.state.breadcrumbs.map((t,e)=>(0,s.jsx)(v.Z.Item,{children:t},e))}),(0,s.jsx)("div",{children:this.state.showForm?this.renderForm():this.renderCards()})]})]})]})}constructor(t){var e;super(t),e=this,(0,n.Z)(this,"formRef",a.createRef()),(0,n.Z)(this,"state",{componentSize:"middle",loading:!0,isLoggedIn:!1,isEmailVerified:!1,data:{},showAlert:!0,translation:{FormLabel:"Personalize your setting:",LanguageSelector:"Change Language:",BackToHomePageButton:"Home Page",LoginButton:"Login/Signin",FormSizeLabel:"Form Size",FormSizeButtonSmall:"Small",FormSizeButtonMiddle:"Middle",FormSizeButtonLarge:"Large",FormAgeSelectionLabel:"Select your age group:",FormIsIllnessLabel:"Do you have any chronic illness?",FormRiskGroupLabel:"Are you in any this groups at greater risk?",FormIsTakingMedLabel:"Are you taking any medications?",yes:"yes",no:"no",Notice:"Notice",SettingBread:"Setting",LanguageBread:"Language",SaveButton:"Save and back",LoggedInText:"Your information will get protection",NotLoginText:"You haven't log in, please login to unlock the function of multiple profile",CardContentOne:"Set data",CardContentOneText:"Setting your and your family and friends' personal information and get personalised HSS data.",CardContentTwo:"Set Language",CardContentTwoText:"Change the language for your own, Chinese or English",CardContentThree:"Feature Comming Soon",CardContentThreeTextDisabled:"This place is for our future feature development, it doesn't provide any abled interaction now. ",riskGroupOptions:[{label:"people who are overweight",value:"gold"},{label:"pregnant women and breastfeeding mothers",value:"cyan"}]},breadcrumbs:[],content:"cards",showForm:!1,activeCard:"",settingOptions:[],openProfile:!1}),(0,n.Z)(this,"onFormValueChange",(t,e)=>{this.setState({latestFormValues:e})}),(0,n.Z)(this,"handleBackToHomePage",t=>{this.setState({loading:!0}),r().push({pathname:"/"})}),(0,n.Z)(this,"handleOpenChange",t=>{t?this.setState({open:!0},()=>{this.doLogin()}):this.setState({open:!1})}),(0,n.Z)(this,"handlePopoverClose",()=>{this.setState({open:!1})}),(0,n.Z)(this,"doLogin",()=>{let t=i(74811);(t.auth.AuthUI.getInstance()||new t.auth.AuthUI(D.Z.auth())).start("#firebaseui",{callbacks:{signInSuccessWithAuthResult:async(t,e)=>{this.setState({open:!1});let i=t.additionalUserInfo.isNewUser;return t.user.emailVerified||this.setState({isEmailVerified:!1}),i&&(t.user.emailVerified?(0,N.pN)("users/".concat(t.user.uid),{emailSubscription:!0}).then(()=>{console.log("Operation successful")}).catch(t=>(console.error("Operation failed:",t),(0,V.Z)("error",this.state.translation.Alert.Error.SomethingWentWrongTitle,this.state.translation.Alert.Error.SaveDataErrorDescription),!1)):((0,V.Z)("success",this.state.translation.Alert.Success.LoginSuccessTitle,this.state.translation.Alert.Success.LoginSuccessDescription),t.user.sendEmailVerification().then(()=>{(0,V.Z)("info",this.state.translation.Alert.Info.EmailverficationTitle,this.state.translation.Alert.Info.EmailverficationDescription)}),this.setState({loading:!0}),await this.loadTranslation())),(0,V.Z)("success",this.state.translation.Alert.Success.LoginSuccessTitle,this.state.translation.Alert.Success.LoginSuccessDescription),this.setState({loading:!0}),await this.loadTranslation(),!0}},signInFlow:"popup",signInOptions:[D.Z.auth.EmailAuthProvider.PROVIDER_ID,D.Z.auth.GoogleAuthProvider.PROVIDER_ID],tosUrl:"<your-tos-url>",privacyPolicyUrl:"<your-privacy-policy-url>"})}),(0,n.Z)(this,"doSignOut",()=>{D.Z.auth().signOut().then(()=>{this.setState({user:null,openProfile:!1}),(0,V.Z)("success",this.state.translation.Alert.Success.SignOutSuccessTitle,this.state.translation.Alert.Success.SignOutSuccessDescription);let t=this.formRef.current.getFieldsValue();localStorage.setItem("allValue",JSON.stringify(t))}).catch(t=>{console.error("Error logging out:",t),(0,V.Z)("error",this.state.translation.Alert.Error.SignOutErrorTitle,this.state.translation.Alert.Error.SignOutErrorDescription)})}),(0,n.Z)(this,"onSaveData",async function(t){let i=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=await (0,B.b)();i&&e.setState({saveButtonClicked:!0}),n?n.emailVerified?(0,N.pN)("users/".concat(n.uid),{settings:t}).then(()=>{console.log("Operation successful")}).catch(i=>{console.error("Operation failed:",i),(0,V.Z)("error",e.state.translation.Alert.Error.SomethingWentWrongTitle,e.state.translation.Alert.Error.SaveDataErrorDescription),localStorage.setItem("allValue",JSON.stringify(t))}):((0,V.Z)("info",e.state.translation.Alert.Info.SettingSavedTitle,e.state.translation.Alert.Info.SettingSavedAskToVeriftyDescription),localStorage.setItem("allValue",JSON.stringify(t))):((0,V.Z)("info",e.state.translation.Alert.Info.SettingSavedTitle,e.state.translation.Alert.Info.LoginToSaveYourDataDescription),localStorage.setItem("allValue",JSON.stringify(t))),(0,E.Vx)(t),(0,z.wm)(t),(0,V.Z)("success",e.state.translation.Alert.Success.SettingSavedTitle,e.state.translation.Alert.Success.SettingSavedDescription),i&&e.handleBackToHomePage()}),(0,n.Z)(this,"onSaveDataFailed",t=>{console.log(t),(0,V.Z)("error",this.state.translation.Alert.Error.SaveFailedTitle,this.state.translation.Alert.Error.SomethingWentWrongTitle)}),(0,n.Z)(this,"resendVerificationEmail",()=>{let t=D.Z.auth().currentUser;t&&t.sendEmailVerification().then(()=>{(0,V.Z)("info",this.state.translation.Alert.Info.EmailverficationTitle,this.state.translation.Alert.Info.EmailverficationDescription)}).catch(t=>{console.error("Error sending email verification:",t)})}),(0,n.Z)(this,"closeProfilePage",()=>{this.setState({openProfile:!1})}),(0,n.Z)(this,"handleCloseAlert",()=>{this.setState({showAlert:!1})}),(0,n.Z)(this,"handleIndividualCardClick",()=>{this.setState({showForm:!0,activeCard:"individual"})}),(0,n.Z)(this,"handleLanguageCardClick",()=>{this.setState({showForm:!0,activeCard:"language"})}),(0,n.Z)(this,"handleMultipleProfileCardClick",()=>{this.setState({showForm:!0,activeCard:"multiple"})}),(0,n.Z)(this,"renderForm",()=>{if(this.state.showForm){if("individual"===this.state.activeCard)return(0,s.jsxs)(h.Z,{ref:this.formRef,labelCol:{span:24},wrapperCol:{span:24},layout:"vertical",initialValues:this.state.data,onValuesChange:this.onFormValueChange,size:this.state.componentSize,style:{maxWidth:"100%"},onFinish:this.onSaveData,onFinishFailed:this.onSaveDataFailed,children:[(0,s.jsx)(f.Z,{orientation:"left",children:this.state.translation.FormLabel}),this.state.settingOptions.map((t,e)=>this.generateFormElements(t,e+"FormOption")),(0,s.jsx)(h.Z.Item,{children:(0,s.jsx)(g.ZP,{style:{backgroundColor:"#1677ff",color:"white",fontWeight:"bold",width:"100%"},htmlType:"submit",onClick:this.handleSwitchBackToCards,icon:(0,s.jsx)(k.Z,{}),children:this.state.translation.SaveButton})})]});if("language"===this.state.activeCard)return(0,s.jsxs)(h.Z,{children:[(0,s.jsx)(f.Z,{orientation:"left",children:this.state.translation.LanguageSelector}),(0,s.jsx)(h.Z.Item,{children:(0,s.jsx)(A.ZP,{})}),(0,s.jsx)(g.ZP,{style:{backgroundColor:"#1677ff",color:"white",fontWeight:"bold",width:"100%"},htmlType:"submit",onClick:this.handleSwitchBackToCards,icon:(0,s.jsx)(k.Z,{}),children:this.state.translation.SaveButton})]})}}),(0,n.Z)(this,"handleCardClick",t=>{this.state.isLoggedIn&&this.setState({showForm:!0,activeCard:t})}),(0,n.Z)(this,"onProfileTabChange",t=>{}),(0,n.Z)(this,"onProfileTabEdit",(t,e)=>{"add"===e&&this.addProfile(),"delete"===e&&this.removeProfile(t)}),(0,n.Z)(this,"handleSwitchBackToCards",()=>{this.setState({showForm:!1})}),(0,n.Z)(this,"getIconSize",()=>{let t=this.width;return t<=992?"60px":t<=1200?"100px":t<=1600?"140px":"60px"}),(0,n.Z)(this,"renderCards",()=>{switch(this.state.content){case"cards":return(0,s.jsx)("div",{children:(0,s.jsxs)(u.Z,{gutter:[16,16],justify:"space-around",children:[(0,s.jsx)(p.Z,{xs:24,sm:12,md:8,lg:6,children:(0,s.jsx)(l.Z,{hoverable:!0,style:{width:"100%",marginBottom:"20px"},onClick:()=>{r().push("/SettingPage")},cover:(0,s.jsx)("div",{style:{backgroundColor:O.iN[2],display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:(0,s.jsx)(I.Z,{style:{fontSize:"50px",color:"black",paddingTop:"30px",paddingBottom:"30px"}})}),children:(0,s.jsx)(W,{title:this.state.translation.CardContentOne,description:this.state.translation.CardContentOneText})})}),(0,s.jsx)(p.Z,{xs:24,sm:12,md:8,lg:6,children:(0,s.jsx)(l.Z,{hoverable:!0,style:{width:"100%",marginBottom:"20px"},onClick:()=>{this.setState({showForm:!0,breadcrumbs:[this.state.translation.SettingBread,this.state.translation.LanguageBread],activeCard:"language"})},cover:(0,s.jsx)("div",{style:{backgroundColor:"black",display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:(0,s.jsx)(P.Z,{style:{fontSize:"50px",color:"white",paddingTop:"30px",paddingBottom:"30px"}})}),children:(0,s.jsx)(W,{title:this.state.translation.CardContentTwo,description:this.state.translation.CardContentTwoText})})}),(0,s.jsx)(p.Z,{xs:24,sm:12,md:8,lg:6,children:(0,s.jsx)(l.Z,{style:{width:"100%",marginBottom:"10px",opacity:.5,pointerEvents:"none"},onClick:()=>{},cover:(0,s.jsx)("div",{style:{backgroundColor:O.ek[2],display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:(0,s.jsx)(L.Z,{style:{fontSize:"50px",color:"black",paddingTop:"30px",paddingBottom:"30px"}})}),disabled:!this.state.isLoggedIn,children:(0,s.jsx)(W,{title:this.state.translation.CardContentThree,description:this.state.translation.CardContentThreeTextDisabled})})}),(0,s.jsx)(g.ZP,{style:{backgroundColor:"#1677ff",color:"white",fontWeight:"bold",width:"100%",marginBottom:"10px"},htmlType:"submit",onClick:this.handleBackToHomePage,icon:(0,s.jsx)(k.Z,{}),children:this.state.translation.SaveButton})]})});case"form":return this.renderForm;default:return(0,s.jsx)(y.Z,{})}})}}e.default=(0,o.withRouter)((0,Z.O)(H))}},function(t){t.O(0,[3662,2016,1627,2677,8717,5871,3840,4496,6785,4689,939,9128,3681,3230,9774,2888,179],function(){return t(t.s=20310)}),_N_E=t.O()}]);